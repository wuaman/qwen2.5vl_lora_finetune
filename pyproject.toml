[build-system]
# æ‰“åŒ…åˆ†å‘ä¾èµ–ï¼Œä¸€èˆ¬ç”¨ä¸åˆ°ï¼Œé™¤ééœ€è¦æ‰“åŒ…wheelæ–‡ä»¶
requires = ["setuptools>=61.0", "wheel"]
build-backend = "setuptools.build_meta"
# ==============================
# ğŸ“¦ Setuptools é…ç½®
# ==============================
[tool.setuptools]
# è¿™æ˜¯ä¸€ä¸ªè®­ç»ƒè„šæœ¬é¡¹ç›®ï¼Œä¸åŒ…å«å¯å®‰è£…çš„åŒ…
packages = []


[project]
name = "Qwen2.5-VL-MonkeyOCR-finetune"
version = "0.1.0"
description = "Qwen2.5-VL-MonkeyOCR LoRA Training Script"
readme = "README.md"
authors = [
    { name = "wuaman", email = "aman1239023286@gmail.com" },
]
dependencies = [
    "torch==2.8.0",
    "transformers==4.57.1",
    "accelerate==1.10.1",
    "datasets==4.4.1",
    "peft==0.17.1",
    "swanlab==0.6.13",
    "qwen-vl-utils==0.0.14",
    "pandas==2.3.3",
    "numpy==2.0.2",
    "torchvision==0.23.0",
    "modelscope==1.31.0",
]
requires-python = ">=3.12"

[tool.uv]
python-install-mirror = "https://ghfast.top/https://github.com/astral-sh/python-build-standalone/releases/download"


[project.urls]
Repository = "https://github.com/wuaman/Qwen2.5-VL-MonkeyOCR-finetune"




[[tool.uv.index]]
name = "pytorch-cu128"
url = "https://download.pytorch.org/whl/cu128"
explicit = true

[[tool.uv.index]]
name = "tsinghua"
url = "https://pypi.tuna.tsinghua.edu.cn/simple"
explicit = false

[[tool.uv.index]]
name = "aliyun"
url = "https://mirrors.aliyun.com/pypi/simple"
explicit = false
# ==============================
# ğŸ› ï¸ Ruff å…¨å±€é…ç½®
# ==============================
[tool.ruff]
# å¯ç”¨é¢„è§ˆåŠŸèƒ½
preview = true

# ç›®æ ‡ Python ç‰ˆæœ¬
target-version = "py312"

# è‡ªåŠ¨ä¿®å¤
fix = true
unsafe-fixes = false

# --- æ›´æ–°ï¼šè¡Œé•¿ä¿®æ”¹ä¸º 120 ---
line-length = 120

# ç¼©è¿›å®½åº¦ï¼ˆè§†è§‰å®½åº¦ä¸º4ï¼Œå…·ä½“ç”¨tabè¿˜æ˜¯ç©ºæ ¼ç”± format å†³å®šï¼‰
indent-width = 4

# å¿½ç•¥çš„è·¯å¾„
extend-exclude = [
    ".git",
    "__pycache__",
    "venv",
    ".venv",
    "coco_2014",
	"MonkeyOCR",
	"monkey_data",
	"output",
	".vscode",
	"Qwen",
	"qwen-vl-finetune",
	"Qwen2.5-VL-MonkeyOCR-finetune.egg-info",
]

# ==============================
# ğŸ” Lint è§„åˆ™é…ç½®
# ==============================
[tool.ruff.lint]
# å¯ç”¨çš„è§„åˆ™é›†
# æˆ‘ä¿ç•™äº†ä¹‹å‰è¾ƒå…¨çš„åˆ—è¡¨ï¼Œå› ä¸ºå®ƒå·²ç»åŒ…å«äº†ä½ è¦æ±‚çš„ F, E, W, UP
select = [
    "E", "W", "F",
    "I",
    "UP",
    "C4",
    "TID",
    "ARG",
    "PTH", # è·¯å¾„é—®é¢˜, Path VS os.path
]

# --- æ›´æ–°ï¼šæ·»åŠ  F401 (å¿½ç•¥æœªä½¿ç”¨çš„å¯¼å…¥) ---
# E501: è¡Œé•¿äº¤ç»™ formatter
# D: å¿½ç•¥æ–‡æ¡£ç¼ºå¤±
ignore = [
    "E501", 
    "D", 
    "W191", # æ£€æµ‹ç¼©è¿›ä½¿ç”¨çš„æ˜¯åˆ¶è¡¨ç¬¦tab

]

[tool.ruff.lint.per-file-ignores]
"tests/**.py" = ["S101", "ARG", "PLR0913"]
"scripts/*.py" = ["T20"]

# ==============================
# ğŸ§¹ isort é…ç½®
# ==============================
[tool.ruff.lint.isort]
known-first-party = ["my_project"]
combine-as-imports = true
force-sort-within-sections = true

# ==============================
# âœ¨ Formatter é…ç½®
# ==============================
[tool.ruff.format]
preview = true

# ä½¿ç”¨å•å¼•å·
quote-style = "single"

# --- æ›´æ–°ï¼šç¼©è¿›ä½¿ç”¨ Tab ---
indent-style = "tab"

# --- æ›´æ–°ï¼šå¯ç”¨ docstring ä»£ç å—æ ¼å¼åŒ– ---
docstring-code-format = true

# ä¿æŒé»˜è®¤ï¼ˆå…¼å®¹ Black çš„é€—å·è¡Œä¸ºï¼‰
skip-magic-trailing-comma = false

# [tool.pyright]
# typeCheckingMode = "basic"

# exclude = [
#   "qwen-vl-finetune",
#   "venv",
#   ".venv",
# ]
# reportArgumentType = false
# reportGeneralTypeIssues = false
# reportAttributeAccessIssue = false